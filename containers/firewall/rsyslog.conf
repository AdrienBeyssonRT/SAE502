# Configuration rsyslog pour le conteneur firewall
# Forwarding des logs vers le collecteur

$ModLoad imuxsock
$ModLoad imklog
$ModLoad imfile
$WorkDirectory /var/lib/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# Lire les logs kernel depuis /var/log/kern.log en continu avec imfile
# Cela capture tous les logs Ã©crits dans kern.log, y compris ceux d'UFW
$InputFileName /var/log/kern.log
$InputFileTag kernel-ufw:
$InputFileStateFile kern-ufw-state
$InputFileSeverity info
$InputFileFacility kern
$InputFilePollInterval 1
$InputFilePersistStateInterval 1
$InputRunFileMonitor

# Forwarder TOUS les logs kernel vers le logcollector en UDP (@@ = UDP)
kern.* @@logcollector:514

# Forwarder aussi les logs lus depuis le fichier kern.log
kernel-ufw:* @@logcollector:514

# Local logging (fallback)
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
cron.* /var/log/cron
kern.* /var/log/kern.log



