# Configuration rsyslog pour le conteneur firewall
# Forwarding des logs kernel (UFW inclus) via imklog uniquement (pas imfile → évite AppArmor)

$ModLoad imuxsock
$ModLoad imklog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# imklog lit /dev/kmsg (buffer noyau) : pas de lecture fichier, pas de blocage AppArmor
# Tous les logs kernel (dont UFW/netfilter) sont envoyés à Splunk en UDP
kern.* @splunk:514

# Local logging (fallback)
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
cron.* /var/log/cron
kern.* /var/log/kern.log



