# Configuration rsyslog pour le conteneur firewall
# Forwarding des logs vers le collecteur

$ModLoad imuxsock
$ModLoad imjournal
$ModLoad imklog
$ModLoad imfile
$WorkDirectory /var/lib/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# Lire les logs kernel depuis /var/log/kern.log en continu
$InputFileName /var/log/kern.log
$InputFileTag kernel-ufw:
$InputFileStateFile kern-ufw-state
$InputFileSeverity info
$InputFileFacility kern
$InputFilePollInterval 1
$InputFilePersistStateInterval 1
$InputRunFileMonitor

# Forward all kernel logs (where UFW writes) to logcollector via UDP
kern.* @logcollector:514
# Forward les logs lus depuis le fichier
kernel-ufw:* @logcollector:514
# Also forward all other logs
*.* @logcollector:514

# Local logging (fallback)
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
cron.* /var/log/cron
kern.* /var/log/kern.log



