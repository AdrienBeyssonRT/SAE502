# Configuration rsyslog pour le conteneur firewall
# Forwarding des logs vers le collecteur

$ModLoad imuxsock
$ModLoad imjournal
$ModLoad imklog
$WorkDirectory /var/lib/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# Forward all kernel logs (where UFW writes) to logcollector via UDP
kern.* @logcollector:514
# Also forward all other logs
*.* @logcollector:514

# Local logging (fallback)
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
cron.* /var/log/cron
kern.* /var/log/kern.log



