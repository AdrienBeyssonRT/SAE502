# Configuration rsyslog serveur pour réception des logs

$ModLoad imuxsock
$ModLoad imjournal
$ModLoad imudp
$UDPServerRun 514
$WorkDirectory /var/lib/rsyslog
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# Activer la réception UDP sur toutes les interfaces
$UDPServerAddress 0.0.0.0

# Réception des logs du firewall
# Template pour les logs avec nom de fichier basé sur la date
$template FirewallLogs,"/var/log/firewall/firewall_%$YEAR%-%$MONTH%-%$DAY%.log"
# Stocker tous les logs reçus (avec flush immédiat)
*.* ?FirewallLogs
& stop

# Logs locaux (fallback)
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
cron.* /var/log/cron



