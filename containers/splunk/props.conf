# Configuration des propriétés pour parser les logs UFW
# Ce fichier définit comment Splunk doit parser les logs reçus

[syslog]
SHOULD_LINEMERGE = false
TIME_PREFIX = ^
MAX_TIMESTAMP_LOOKAHEAD = 128
TIME_FORMAT = %b %d %H:%M:%S

# Extraction des champs UFW depuis les logs
EXTRACT-ufw_action = ^.*\[UFW\s+(?<ufw_action>BLOCK|ALLOW|LIMIT)\].*$
EXTRACT-ufw_src_ip = SRC=(?<src_ip>\d+\.\d+\.\d+\.\d+)
EXTRACT-ufw_dst_ip = DST=(?<dst_ip>\d+\.\d+\.\d+\.\d+)
EXTRACT-ufw_dport = DPT=(?<dport>\d+)
EXTRACT-ufw_sport = SPT=(?<sport>\d+)
EXTRACT-ufw_proto = PROTO=(?<proto>\w+)
EXTRACT-ufw_in = IN=(?<interface_in>\w+)
EXTRACT-ufw_out = OUT=(?<interface_out>\w+)

# Créer des champs calculés pour faciliter les recherches
EVAL-action = coalesce(ufw_action, "NETWORK")
EVAL-is_blocked = if(match(action, "BLOCK"), 1, 0)
EVAL-is_allowed = if(match(action, "ALLOW"), 1, 0)






